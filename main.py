"""
Unabridged contains same data as in standard but alot more fields. (not shortened)
Probably ok with just using Standard
"""
import csv
import requests

STANDARD_FILE_PATH = "./Principal files/ASCII Text Files/Standard/Standard DATA.AP"
CSM_FILE_PATH = "./Principal files/ASCII Text Files/CSM.FT"

FOOD_REQUEST_URL = "http://localhost:3000/api/food"
CSM_REQUEST_URL = "http://localhost:3000/api/food/csm"

def safe_float(value):
    return float(value) if value != "" else 0.0


class ProcessNZFoodCompData:
    def __init__(self, standard_file_path, csm_file_path, food_request_url, csm_request_url):
        self.food_data = self.__process_ft_to_dict(standard_file_path, True)
        self.csm_data = self.__process_ft_to_dict(csm_file_path, False)
        self.food_request_url = food_request_url
        self.csm_request_url = csm_request_url

        self.id_mapping = []

    def __process_ft_to_dict(self, file_path, use_units: bool):
        with open(file_path, encoding="utf-8") as file:
            reader = csv.reader(file, delimiter="~")
            rows = list(reader)

        # Separate parts
        column_names = rows[1]
        units = rows[2] if use_units else ['-' for _ in range(len(rows[2]))]
        data = rows[3:] if use_units else rows[2:]

        # Convert to dicts
        dict_data = []
        for row in data:
            d = dict()
            for col, un, val in zip(column_names, units, row):
                d[col] = (val, un)
            dict_data.append(d)
        return dict_data

    def __reformat_food_entry(self, food):
        try:
            return {
                "NZCompId": food["FoodID"][0],
                "name": food["Food Name"][0],
                "kilocalories": safe_float(food["Energy, total metabolisable (kcal, including dietary fibre)"][0]),
                "carbohydrates": safe_float(food["Available carbohydrate, FSANZ"][0]),
                "sugars": safe_float(food["Sugars, total"][0]),
                "fat": safe_float(food["Fat, total"][0]),
                "fibre": safe_float(food["Fibre, total dietary"][0]),
                "protein": safe_float(food["Protein, total; calculated from total nitrogen"][0]),

                "alcohol": safe_float(food["Alcohol"][0]),
                "alphaCarotene": safe_float(food["Alpha-carotene"][0]),
                "alphaTocopherol": safe_float(food["Alpha-tocopherol"][0]),
                "ash": safe_float(food["Ash"][0]),
                "betaCarotene": safe_float(food["Beta-carotene"][0]),
                "betaTocopherol": safe_float(food["Beta-tocopherol"][0]),
                "caffeine": safe_float(food["Caffeine"][0]),
                "calcium": safe_float(food["Calcium"][0]),
                "cholesterol": safe_float(food["Cholesterol"][0]),
                "copper": safe_float(food["Copper"][0]),
                "deltaTocopherol": safe_float(food["Delta-tocopherol"][0]),
                "dietaryFolateEquivalents": safe_float(food["Dietary folate equivalents"][0]),
                "dryMatter": safe_float(food["Dry matter"][0]),
                "fattyAcidsOmega3": safe_float(food["Fatty acids, total polyunsaturated omega-3"][0]),
                "fattyAcidsMono": safe_float(food["Fatty acids, total monounsaturated"][0]),
                "fattyAcidsPoly": safe_float(food["Fatty acids, total polyunsaturated"][0]),
                "fattyAcidsSaturated": safe_float(food["Fatty acids, total saturated"][0]),
                "fattyAcidsTrans": safe_float(food["Fatty acids, total trans"][0]),
                "fibreInsoluble": safe_float(food["Fibre, water-insoluble"][0]),
                "fibreSoluble": safe_float(food["Fibre, water-soluble"][0]),
                "folateTotal": safe_float(food["Folate, total"][0]),
                "fructose": safe_float(food["Fructose"][0]),
                "galactose": safe_float(food["Galactose"][0]),
                "gammaTocopherol": safe_float(food["Gamma-tocopherol"][0]),
                "glucose": safe_float(food["Glucose"][0]),
                "iodide": safe_float(food["Iodide"][0]),
                "iron": safe_float(food["Iron"][0]),
                "lactose": safe_float(food["Lactose"][0]),
                "magnesium": safe_float(food["Magnesium"][0]),
                "maltose": safe_float(food["Maltose"][0]),
                "manganese": safe_float(food["Manganese"][0]),
                "niacinTotal": safe_float(food["Niacin equivalents, total"][0]),
                "nitrogen": safe_float(food["Nitrogen, total"][0]),
                "phosphorus": safe_float(food["Phosphorus"][0]),
                "potassium": safe_float(food["Potassium"][0]),
                "retinol": safe_float(food["Retinol"][0]),
                "riboflavin": safe_float(food["Riboflavin"][0]),
                "selenium": safe_float(food["Selenium"][0]),
                "sodium": safe_float(food["Sodium"][0]),
                "starch": safe_float(food["Starch, total"][0]),
                "sucrose": safe_float(food["Sucrose"][0]),
                "sugarAdded": safe_float(food["Sugar, added"][0]),
                "sugarFree": safe_float(food["Sugar, free"][0]),
                "thiamin": safe_float(food["Thiamin"][0]),
                "tryptophan": safe_float(food["Tryptophan"][0]),
                "vitaminA": safe_float(food["Vitamin A, retinol activity equivalents"][0]),
                "vitaminB12": safe_float(food["Vitamin B12"][0]),
                "vitaminB6": safe_float(food["Vitamin B6"][0]),
                "vitaminC": safe_float(food["Vitamin C"][0]),
                "vitaminD": safe_float(food["Vitamin D; calculated by summation"][0]),
                "vitaminE": safe_float(food["Vitamin E, alpha-tocopherol equivalents"][0]),
                "water": safe_float(food["Water"][0]),
                "zinc": safe_float(food["Zinc"][0])
            }
        except KeyError as e:
            print(f"Missing key: {e}")
            return None
        except ValueError as e:
            print(f"Value error: {e}")
            return None

    def __reformat_csm_entry(self, csm):
        food_id_mapping = {'A10001': 1, 'A1011': 2, 'A1014': 3, 'A1015': 4, 'A1016': 5, 'A1029': 6, 'A1030': 7, 'A1031': 8, 'A1032': 9, 'A1033': 10, 'A1034': 11, 'A1035': 12, 'A1036': 13, 'A1037': 14, 'A1060': 15, 'A1061': 16, 'A1062': 17, 'A1063': 18, 'A1064': 19, 'A1066': 20, 'A1067': 21, 'A1068': 22, 'A1069': 23, 'A1070': 24, 'A1071': 25, 'A1072': 26, 'A1073': 27, 'A1074': 28, 'A1075': 29, 'A1076': 30, 'A1097': 31, 'A1098': 32, 'A11': 33, 'A1100': 34, 'A1101': 35, 'A1119': 36, 'A1120': 37, 'A1121': 38, 'A1122': 39, 'A1123': 40, 'A1124': 41, 'A1125': 42, 'A1126': 43, 'A1133': 44, 'A1134': 45, 'A1135': 46, 'A1136': 47, 'A1138': 48, 'A1139': 49, 'A1140': 50, 'A1141': 51, 'A1142': 52, 'A1143': 53, 'A1144': 54, 'A1145': 55, 'A1146': 56, 'A1147': 57, 'A1148': 58, 'A1152': 59, 'A1153': 60, 'A1154': 61, 'A1158': 62, 'A1159': 63, 'A1160': 64, 'A1161': 65, 'A1162': 66, 'A1163': 67, 'A1164': 68, 'A1165': 69, 'A1166': 70, 'A1167': 71, 'A1168': 72, 'A1169': 73, 'A1170': 74, 'A1171': 75, 'A1172': 76, 'A1173': 77, 'A1174': 78, 'A1175': 79, 'A1176': 80, 'A1177': 81, 'A1178': 82, 'A1179': 83, 'A1180': 84, 'A1181': 85, 'A1182': 86, 'A1183': 87, 'A1184': 88, 'A1185': 89, 'A1186': 90, 'A1187': 91, 'A1188': 92, 'A1189': 93, 'A119': 94, 'A1190': 95, 'A1191': 96, 'A1192': 97, 'A1195': 98, 'A1196': 99, 'A1197': 100, 'A1198': 101, 'A1199': 102, 'A12': 103, 'A1200': 104, 'A1201': 105, 'A1202': 106, 'A1203': 107, 'A1204': 108, 'A1205': 109, 'A1206': 110, 'A1207': 111, 'A1208': 112, 'A1209': 113, 'A1210': 114, 'A1211': 115, 'A127': 116, 'A128': 117, 'A129': 118, 'A130': 119, 'A133': 120, 'A134': 121, 'A135': 122, 'A136': 123, 'A137': 124, 'A138': 125, 'A139': 126, 'A140': 127, 'A141': 128, 'A146': 129, 'A147': 130, 'A148': 131, 'A15': 132, 'A151': 133, 'A16': 134, 'A170': 135, 'A171': 136, 'A178': 137, 'A179': 138, 'A180': 139, 'A181': 140, 'A182': 141, 'A183': 142, 'A20': 143, 'A206': 144, 'A214': 145, 'A215': 146, 'A216': 147, 'A217': 148, 'A219': 149, 'A232': 150, 'A233': 151, 'A234': 152, 'A235': 153, 'A24': 154, 'A27': 155, 'A28': 156, 'A33': 157, 'A45': 158, 'A5': 159, 'A6': 160, 'A62': 161, 'A63': 162, 'A64': 163, 'A65': 164, 'A66': 165, 'A67': 166, 'A68': 167, 'A7': 168, 'A71': 169, 'A73': 170, 'A74': 171, 'A76': 172, 'A8': 173, 'A82': 174, 'A9': 175, 'A93': 176, 'B1003': 177, 'B1009': 178, 'B1010': 179, 'B1011': 180, 'B1012': 181, 'B1015': 182, 'B1016': 183, 'B1017': 184, 'B1018': 185, 'B1019': 186, 'B1020': 187, 'B1021': 188, 'B1022': 189, 'B1023': 190, 'B1024': 191, 'B1025': 192, 'B1026': 193, 'B1027': 194, 'B1028': 195, 'B1029': 196, 'B1030': 197, 'B1031': 198, 'B1032': 199, 'B1033': 200, 'B1034': 201, 'B1035': 202, 'B1036': 203, 'B1037': 204, 'B1038': 205, 'B1039': 206, 'B1040': 207, 'B1041': 208, 'B1042': 209, 'B11': 210, 'B12': 211, 'B13': 212, 'B15': 213, 'B16': 214, 'B17': 215, 'B18': 216, 'B19': 217, 'B20': 218, 'B21': 219, 'B22': 220, 'B23': 221, 'B35': 222, 'B38': 223, 'B39': 224, 'B40': 225, 'B5': 226, 'B9': 227, 'C100': 228, 'C10001': 229, 'C10002': 230, 'C10003': 231, 'C10004': 232, 'C10005': 233, 'C10006': 234, 'C10007': 235, 'C10008': 236, 'C10009': 237, 'C1001': 238, 'C10010': 239, 'C10011': 240, 'C10012': 241, 'C10013': 242, 'C10014': 243, 'C10015': 244, 'C10016': 245, 'C10017': 246, 'C10018': 247, 'C10019': 248, 'C1002': 249, 'C10020': 250, 'C10021': 251, 'C10022': 252, 'C10023': 253, 'C10024': 254, 'C10025': 255, 'C10026': 256, 'C10027': 257, 'C10028': 258, 'C10029': 259, 'C1003': 260, 'C10030': 261, 'C10031': 262, 'C10032': 263, 'C10033': 264, 'C10034': 265, 'C10035': 266, 'C10036': 267, 'C10037': 268, 'C10038': 269, 'C10039': 270, 'C1004': 271, 'C1005': 272, 'C1006': 273, 'C1007': 274, 'C101': 275, 'C1017': 276, 'C1020': 277, 'C1021': 278, 'C1022': 279, 'C1023': 280, 'C1024': 281, 'C1026': 282, 'C1027': 283, 'C1028': 284, 'C1029': 285, 'C1030': 286, 'C1031': 287, 'C1032': 288, 'C1033': 289, 'C1034': 290, 'C1036': 291, 'C1037': 292, 'C1038': 293, 'C1039': 294, 'C1040': 295, 'C1041': 296, 'C1042': 297, 'C1043': 298, 'C1044': 299, 'C1045': 300, 'C1046': 301, 'C1047': 302, 'C1048': 303, 'C1050': 304, 'C1055': 305, 'C107': 306, 'C1090': 307, 'C1091': 308, 'C1092': 309, 'C1094': 310, 'C1095': 311, 'C1096': 312, 'C1097': 313, 'C1098': 314, 'C1099': 315, 'C11': 316, 'C1100': 317, 'C1102': 318, 'C1103': 319, 'C1104': 320, 'C1105': 321, 'C1106': 322, 'C1107': 323, 'C1108': 324, 'C1112': 325, 'C1113': 326, 'C1114': 327, 'C1115': 328, 'C1116': 329, 'C1117': 330, 'C1118': 331, 'C1119': 332, 'C112': 333, 'C1120': 334, 'C1121': 335, 'C1122': 336, 'C1123': 337, 'C1124': 338, 'C1125': 339, 'C1126': 340, 'C1127': 341, 'C1128': 342, 'C1129': 343, 'C1130': 344, 'C1132': 345, 'C1133': 346, 'C1134': 347, 'C1135': 348, 'C1136': 349, 'C1137': 350, 'C114': 351, 'C1140': 352, 'C1141': 353, 'C1150': 354, 'C1151': 355, 'C1152': 356, 'C1153': 357, 'C1154': 358, 'C1155': 359, 'C1156': 360, 'C1158': 361, 'C116': 362, 'C1161': 363, 'C1162': 364, 'C1163': 365, 'C1165': 366, 'C1166': 367, 'C1167': 368, 'C1168': 369, 'C1169': 370, 'C117': 371, 'C118': 372, 'C12': 373, 'C120': 374, 'C123': 375, 'C126': 376, 'C127': 377, 'C129': 378, 'C131': 379, 'C137': 380, 'C138': 381, 'C143': 382, 'C15': 383, 'C166': 384, 'C18': 385, 'C20': 386, 'C22': 387, 'C24': 388, 'C26': 389, 'C29': 390, 'C30': 391, 'C31': 392, 'C32': 393, 'C33': 394, 'C34': 395, 'C35': 396, 'C37': 397, 'C38': 398, 'C39': 399, 'C40': 400, 'C41': 401, 'C42': 402, 'C45': 403, 'C47': 404, 'C48': 405, 'C49': 406, 'C50': 407, 'C51': 408, 'C52': 409, 'C54': 410, 'C55': 411, 'C56': 412, 'C57': 413, 'C58': 414, 'C59': 415, 'C6': 416, 'C60': 417, 'C61': 418, 'C63': 419, 'C64': 420, 'C67': 421, 'C7': 422, 'C74': 423, 'C76': 424, 'C77': 425, 'C78': 426, 'C79': 427, 'C80': 428, 'C81': 429, 'C82': 430, 'C83': 431, 'C86': 432, 'C90': 433, 'C92': 434, 'C96': 435, 'C99': 436, 'D10001': 437, 'D10002': 438, 'D10003': 439, 'D10004': 440, 'D10005': 441, 'D10006': 442, 'D1002': 443, 'D1007': 444, 'D1008': 445, 'D1012': 446, 'D1016': 447, 'D1017': 448, 'D1018': 449, 'D1021': 450, 'D1025': 451, 'D1026': 452, 'D1029': 453, 'D1032': 454, 'D1035': 455, 'D1036': 456, 'D1037': 457, 'D1038': 458, 'D1041': 459, 'D1042': 460, 'D1043': 461, 'D1044': 462, 'D1045': 463, 'D1046': 464, 'D1047': 465, 'D1048': 466, 'D1049': 467, 'D1050': 468, 'D1051': 469, 'D1052': 470, 'D1053': 471, 'D1054': 472, 'D1055': 473, 'D1056': 474, 'D1057': 475, 'D1060': 476, 'D1061': 477, 'D1062': 478, 'D1066': 479, 'D1069': 480, 'D22': 481, 'D43': 482, 'E1': 483, 'E100': 484, 'E10001': 485, 'E10002': 486, 'E10004': 487, 'E10005': 488, 'E10008': 489, 'E10009': 490, 'E1001': 491, 'E10010': 492, 'E10011': 493, 'E10012': 494, 'E10013': 495, 'E10014': 496, 'E10016': 497, 'E10017': 498, 'E1003': 499, 'E1004': 500, 'E1005': 501, 'E1006': 502, 'E1014': 503, 'E1015': 504, 'E1016': 505, 'E1020': 506, 'E1021': 507, 'E1022': 508, 'E1024': 509, 'E1025': 510, 'E1042': 511, 'E1043': 512, 'E1046': 513, 'E1047': 514, 'E1048': 515, 'E1049': 516, 'E1050': 517, 'E1051': 518, 'E1053': 519, 'E1054': 520, 'E1055': 521, 'E1056': 522, 'E1057': 523, 'E1060': 524, 'E1063': 525, 'E1064': 526, 'E1065': 527, 'E1066': 528, 'E1067': 529, 'E1068': 530, 'E1069': 531, 'E1070': 532, 'E1071': 533, 'E1072': 534, 'E1073': 535, 'E1074': 536, 'E1075': 537, 'E1076': 538, 'E1077': 539, 'E1078': 540, 'E1079': 541, 'E1080': 542, 'E1081': 543, 'E1082': 544, 'E1083': 545, 'E1084': 546, 'E1085': 547, 'E1086': 548, 'E1087': 549, 'E1088': 550, 'E1089': 551, 'E1090': 552, 'E1091': 553, 'E1093': 554, 'E1094': 555, 'E1095': 556, 'E1096': 557, 'E1097': 558, 'E1098': 559, 'E11': 560, 'E111': 561, 'E112': 562, 'E115': 563, 'E116': 564, 'E118': 565, 'E119': 566, 'E12': 567, 'E133': 568, 'E134': 569, 'E14': 570, 'E2': 571, 'E21': 572, 'E22': 573, 'E23': 574, 'E29': 575, 'E3': 576, 'E30': 577, 'E34': 578, 'E35': 579, 'E36': 580, 'E37': 581, 'E39': 582, 'E4': 583, 'E40': 584, 'E43': 585, 'E48': 586, 'E49': 587, 'E50': 588, 'E51': 589, 'E53': 590, 'E56': 591, 'E57': 592, 'E59': 593, 'E6': 594, 'E60': 595, 'E61': 596, 'E62': 597, 'E63': 598, 'E64': 599, 'E67': 600, 'E68': 601, 'E69': 602, 'E7': 603, 'E73': 604, 'E74': 605, 'E77': 606, 'E78': 607, 'E80': 608, 'E83': 609, 'E85': 610, 'E86': 611, 'E9': 612, 'E99': 613, 'F1': 614, 'F10002': 615, 'F10003': 616, 'F10004': 617, 'F10005': 618, 'F10006': 619, 'F10007': 620, 'F10008': 621, 'F10009': 622, 'F1001': 623, 'F10010': 624, 'F10011': 625, 'F10012': 626, 'F10013': 627, 'F10014': 628, 'F10015': 629, 'F10016': 630, 'F10017': 631, 'F10018': 632, 'F10019': 633, 'F1002': 634, 'F10020': 635, 'F10021': 636, 'F10022': 637, 'F10023': 638, 'F10024': 639, 'F10025': 640, 'F10026': 641, 'F10027': 642, 'F10028': 643, 'F10029': 644, 'F1003': 645, 'F10030': 646, 'F10031': 647, 'F10032': 648, 'F10033': 649, 'F10034': 650, 'F10035': 651, 'F10036': 652, 'F10037': 653, 'F10038': 654, 'F1004': 655, 'F10040': 656, 'F1005': 657, 'F10050': 658, 'F10051': 659, 'F10052': 660, 'F10054': 661, 'F10055': 662, 'F10058': 663, 'F1006': 664, 'F1007': 665, 'F1008': 666, 'F1009': 667, 'F1010': 668, 'F1011': 669, 'F1012': 670, 'F1013': 671, 'F1014': 672, 'F1015': 673, 'F1046': 674, 'F1047': 675, 'F1048': 676, 'F1049': 677, 'F1050': 678, 'F1051': 679, 'F1057': 680, 'F1058': 681, 'F1061': 682, 'F1062': 683, 'F1063': 684, 'F1064': 685, 'F1066': 686, 'F1067': 687, 'F1068': 688, 'F1070': 689, 'F1071': 690, 'F1083': 691, 'F1084': 692, 'F1085': 693, 'F1086': 694, 'F1087': 695, 'F1088': 696, 'F1089': 697, 'F109': 698, 'F1090': 699, 'F1091': 700, 'F1092': 701, 'F1093': 702, 'F1095': 703, 'F1096': 704, 'F1097': 705, 'F1098': 706, 'F1099': 707, 'F110': 708, 'F1100': 709, 'F1101': 710, 'F1102': 711, 'F1103': 712, 'F1104': 713, 'F1105': 714, 'F1106': 715, 'F1107': 716, 'F1108': 717, 'F1109': 718, 'F111': 719, 'F1110': 720, 'F1111': 721, 'F1112': 722, 'F1113': 723, 'F1114': 724, 'F1115': 725, 'F1116': 726, 'F112': 727, 'F113': 728, 'F114': 729, 'F118': 730, 'F119': 731, 'F122': 732, 'F13': 733, 'F15': 734, 'F16': 735, 'F17': 736, 'F18': 737, 'F20': 738, 'F21': 739, 'F27': 740, 'F28': 741, 'F29': 742, 'F4': 743, 'F42': 744, 'F44': 745, 'F46': 746, 'F47': 747, 'F48': 748, 'F49': 749, 'F5': 750, 'F51': 751, 'F52': 752, 'F54': 753, 'F60': 754, 'F75': 755, 'F76': 756, 'F77': 757, 'F78': 758, 'F85': 759, 'F87': 760, 'F88': 761, 'F89': 762, 'F91': 763, 'F96': 764, 'F97': 765, 'F98': 766, 'F99': 767, 'G1': 768, 'G10001': 769, 'G10002': 770, 'G10003': 771, 'G1016': 772, 'G1017': 773, 'G1019': 774, 'G1020': 775, 'G1021': 776, 'G1022': 777, 'G1023': 778, 'G1024': 779, 'G1025': 780, 'G2': 781, 'G4': 782, 'H1': 783, 'H10': 784, 'H10001': 785, 'H10002': 786, 'H10003': 787, 'H10004': 788, 'H10005': 789, 'H10006': 790, 'H10007': 791, 'H10008': 792, 'H10009': 793, 'H10010': 794, 'H10011': 795, 'H10012': 796, 'H10013': 797, 'H10014': 798, 'H10015': 799, 'H10016': 800, 'H10017': 801, 'H10018': 802, 'H10019': 803, 'H1002': 804, 'H10021': 805, 'H1003': 806, 'H1004': 807, 'H1005': 808, 'H1006': 809, 'H1012': 810, 'H1013': 811, 'H1014': 812, 'H1015': 813, 'H1016': 814, 'H1017': 815, 'H1018': 816, 'H1019': 817, 'H1020': 818, 'H1021': 819, 'H1022': 820, 'H1023': 821, 'H1024': 822, 'H1025': 823, 'H1026': 824, 'H1027': 825, 'H1028': 826, 'H1030': 827, 'H1031': 828, 'H1039': 829, 'H1041': 830, 'H1042': 831, 'H1043': 832, 'H1044': 833, 'H1045': 834, 'H1046': 835, 'H1048': 836, 'H1049': 837, 'H1051': 838, 'H1054': 839, 'H1055': 840, 'H1056': 841, 'H1058': 842, 'H1059': 843, 'H1061': 844, 'H11': 845, 'H12': 846, 'H13': 847, 'H14': 848, 'H140': 849, 'H141': 850, 'H142': 851, 'H143': 852, 'H144': 853, 'H145': 854, 'H146': 855, 'H147': 856, 'H15': 857, 'H151': 858, 'H152': 859, 'H153': 860, 'H154': 861, 'H156': 862, 'H157': 863, 'H158': 864, 'H159': 865, 'H16': 866, 'H161': 867, 'H162': 868, 'H163': 869, 'H165': 870, 'H166': 871, 'H167': 872, 'H168': 873, 'H169': 874, 'H17': 875, 'H172': 876, 'H173': 877, 'H176': 878, 'H177': 879, 'H178': 880, 'H179': 881, 'H18': 882, 'H180': 883, 'H181': 884, 'H182': 885, 'H183': 886, 'H185': 887, 'H186': 888, 'H188': 889, 'H189': 890, 'H19': 891, 'H190': 892, 'H191': 893, 'H192': 894, 'H193': 895, 'H194': 896, 'H195': 897, 'H199': 898, 'H20': 899, 'H200': 900, 'H201': 901, 'H202': 902, 'H204': 903, 'H205': 904, 'H206': 905, 'H207': 906, 'H208': 907, 'H209': 908, 'H21': 909, 'H211': 910, 'H212': 911, 'H213': 912, 'H214': 913, 'H215': 914, 'H22': 915, 'H23': 916, 'H24': 917, 'H25': 918, 'H26': 919, 'H27': 920, 'H28': 921, 'H29': 922, 'H3': 923, 'H31': 924, 'H32': 925, 'H33': 926, 'H34': 927, 'H35': 928, 'H36': 929, 'H37': 930, 'H38': 931, 'H39': 932, 'H4': 933, 'H40': 934, 'H41': 935, 'H42': 936, 'H47': 937, 'H48': 938, 'H5': 939, 'H52': 940, 'H53': 941, 'H54': 942, 'H55': 943, 'H56': 944, 'H57': 945, 'H58': 946, 'H59': 947, 'H6': 948, 'H60': 949, 'H61': 950, 'H62': 951, 'H63': 952, 'H64': 953, 'H65': 954, 'H69': 955, 'H7': 956, 'H70': 957, 'H71': 958, 'H75': 959, 'H78': 960, 'H8': 961, 'H87': 962, 'H89': 963, 'H9': 964, 'H90': 965, 'H93': 966, 'J10001': 967, 'J10002': 968, 'J1001': 969, 'J1002': 970, 'J1003': 971, 'J1004': 972, 'J1005': 973, 'J1006': 974, 'J1007': 975, 'J1008': 976, 'J1009': 977, 'J1010': 978, 'J1011': 979, 'J1012': 980, 'J1013': 981, 'J1020': 982, 'J1021': 983, 'J1022': 984, 'J1023': 985, 'J1028': 986, 'J1029': 987, 'J1030': 988, 'J1031': 989, 'J1032': 990, 'J1033': 991, 'J1035': 992, 'J1036': 993, 'J1037': 994, 'J1039': 995, 'J1040': 996, 'J11': 997, 'J12': 998, 'J14': 999, 'J17': 1000, 'J21': 1001, 'J28': 1002, 'J29': 1003, 'J3': 1004, 'J30': 1005, 'J31': 1006, 'J32': 1007, 'J38': 1008, 'J39': 1009, 'J4': 1010, 'J40': 1011, 'J5': 1012, 'J6': 1013, 'J60': 1014, 'J61': 1015, 'J7': 1016, 'J9': 1017, 'K1': 1018, 'K10': 1019, 'K100': 1020, 'K10001': 1021, 'K10002': 1022, 'K1005': 1023, 'K1006': 1024, 'K1007': 1025, 'K1008': 1026, 'K1009': 1027, 'K1010': 1028, 'K1011': 1029, 'K1012': 1030, 'K1013': 1031, 'K1014': 1032, 'K1015': 1033, 'K1016': 1034, 'K1017': 1035, 'K1018': 1036, 'K1019': 1037, 'K102': 1038, 'K1021': 1039, 'K1022': 1040, 'K1023': 1041, 'K1024': 1042, 'K1025': 1043, 'K1026': 1044, 'K1027': 1045, 'K1028': 1046, 'K1029': 1047, 'K103': 1048, 'K1030': 1049, 'K1031': 1050, 'K1032': 1051, 'K1034': 1052, 'K1035': 1053, 'K1036': 1054, 'K1037': 1055, 'K1038': 1056, 'K1039': 1057, 'K104': 1058, 'K1040': 1059, 'K1041': 1060, 'K1042': 1061, 'K1043': 1062, 'K1044': 1063, 'K1045': 1064, 'K1046': 1065, 'K1047': 1066, 'K1048': 1067, 'K1049': 1068, 'K105': 1069, 'K1050': 1070, 'K1051': 1071, 'K1052': 1072, 'K1053': 1073, 'K1054': 1074, 'K1055': 1075, 'K1056': 1076, 'K1057': 1077, 'K1058': 1078, 'K1059': 1079, 'K106': 1080, 'K1060': 1081, 'K1061': 1082, 'K1062': 1083, 'K1063': 1084, 'K1064': 1085, 'K1065': 1086, 'K1066': 1087, 'K1067': 1088, 'K107': 1089, 'K108': 1090, 'K109': 1091, 'K110': 1092, 'K111': 1093, 'K112': 1094, 'K114': 1095, 'K115': 1096, 'K116': 1097, 'K117': 1098, 'K118': 1099, 'K119': 1100, 'K12': 1101, 'K120': 1102, 'K121': 1103, 'K125': 1104, 'K126': 1105, 'K127': 1106, 'K128': 1107, 'K129': 1108, 'K13': 1109, 'K130': 1110, 'K131': 1111, 'K132': 1112, 'K133': 1113, 'K134': 1114, 'K136': 1115, 'K137': 1116, 'K138': 1117, 'K139': 1118, 'K14': 1119, 'K140': 1120, 'K141': 1121, 'K142': 1122, 'K143': 1123, 'K144': 1124, 'K145': 1125, 'K146': 1126, 'K147': 1127, 'K148': 1128, 'K149': 1129, 'K15': 1130, 'K150': 1131, 'K151': 1132, 'K155': 1133, 'K156': 1134, 'K158': 1135, 'K16': 1136, 'K160': 1137, 'K163': 1138, 'K164': 1139, 'K17': 1140, 'K177': 1141, 'K178': 1142, 'K179': 1143, 'K18': 1144, 'K180': 1145, 'K185': 1146, 'K186': 1147, 'K188': 1148, 'K19': 1149, 'K2': 1150, 'K20': 1151, 'K21': 1152, 'K22': 1153, 'K23': 1154, 'K24': 1155, 'K27': 1156, 'K3': 1157, 'K30': 1158, 'K31': 1159, 'K32': 1160, 'K33': 1161, 'K34': 1162, 'K35': 1163, 'K36': 1164, 'K37': 1165, 'K4': 1166, 'K43': 1167, 'K45': 1168, 'K46': 1169, 'K48': 1170, 'K49': 1171, 'K50': 1172, 'K51': 1173, 'K53': 1174, 'K54': 1175, 'K56': 1176, 'K57': 1177, 'K58': 1178, 'K59': 1179, 'K7': 1180, 'K78': 1181, 'K79': 1182, 'K8': 1183, 'K80': 1184, 'K81': 1185, 'K9': 1186, 'K99': 1187, 'L1': 1188, 'L10': 1189, 'L10021': 1190, 'L10022': 1191, 'L10058': 1192, 'L10059': 1193, 'L10070': 1194, 'L10071': 1195, 'L10074': 1196, 'L10075': 1197, 'L10091': 1198, 'L10114': 1199, 'L10115': 1200, 'L10116': 1201, 'L10117': 1202, 'L10118': 1203, 'L10119': 1204, 'L10120': 1205, 'L10121': 1206, 'L10122': 1207, 'L10123': 1208, 'L10124': 1209, 'L10125': 1210, 'L10126': 1211, 'L10127': 1212, 'L10128': 1213, 'L10129': 1214, 'L10130': 1215, 'L10131': 1216, 'L10132': 1217, 'L10133': 1218, 'L10134': 1219, 'L10135': 1220, 'L10136': 1221, 'L10137': 1222, 'L10140': 1223, 'L10141': 1224, 'L10142': 1225, 'L10143': 1226, 'L10144': 1227, 'L1015': 1228, 'L10150': 1229, 'L10151': 1230, 'L10152': 1231, 'L10153': 1232, 'L10154': 1233, 'L10155': 1234, 'L10156': 1235, 'L10157': 1236, 'L10158': 1237, 'L1016': 1238, 'L10161': 1239, 'L10162': 1240, 'L1017': 1241, 'L1018': 1242, 'L1019': 1243, 'L102': 1244, 'L1020': 1245, 'L1021': 1246, 'L1023': 1247, 'L103': 1248, 'L1045': 1249, 'L1046': 1250, 'L1047': 1251, 'L1048': 1252, 'L1050': 1253, 'L1051': 1254, 'L1052': 1255, 'L1053': 1256, 'L1054': 1257, 'L1055': 1258, 'L1078': 1259, 'L108': 1260, 'L109': 1261, 'L11': 1262, 'L110': 1263, 'L1101': 1264, 'L112': 1265, 'L1121': 1266, 'L1122': 1267, 'L1123': 1268, 'L1124': 1269, 'L1125': 1270, 'L1126': 1271, 'L1127': 1272, 'L1128': 1273, 'L1129': 1274, 'L113': 1275, 'L1130': 1276, 'L1131': 1277, 'L1132': 1278, 'L1133': 1279, 'L1134': 1280, 'L1135': 1281, 'L1136': 1282, 'L1137': 1283, 'L1138': 1284, 'L1139': 1285, 'L1140': 1286, 'L1141': 1287, 'L1142': 1288, 'L1143': 1289, 'L1144': 1290, 'L1145': 1291, 'L1146': 1292, 'L1147': 1293, 'L1148': 1294, 'L1149': 1295, 'L115': 1296, 'L1150': 1297, 'L1151': 1298, 'L1152': 1299, 'L1153': 1300, 'L1154': 1301, 'L1155': 1302, 'L1156': 1303, 'L1157': 1304, 'L1158': 1305, 'L1159': 1306, 'L116': 1307, 'L1160': 1308, 'L1161': 1309, 'L1162': 1310, 'L1163': 1311, 'L1164': 1312, 'L1165': 1313, 'L1166': 1314, 'L1167': 1315, 'L1168': 1316, 'L117': 1317, 'L1170': 1318, 'L1179': 1319, 'L118': 1320, 'L1180': 1321, 'L1181': 1322, 'L1182': 1323, 'L1183': 1324, 'L1184': 1325, 'L1185': 1326, 'L119': 1327, 'L120': 1328, 'L1208': 1329, 'L1209': 1330, 'L121': 1331, 'L1212': 1332, 'L122': 1333, 'L1225': 1334, 'L1226': 1335, 'L1227': 1336, 'L1228': 1337, 'L1229': 1338, 'L123': 1339, 'L1230': 1340, 'L1231': 1341, 'L1232': 1342, 'L1233': 1343, 'L1234': 1344, 'L1266': 1345, 'L1267': 1346, 'L1268': 1347, 'L127': 1348, 'L128': 1349, 'L129': 1350, 'L130': 1351, 'L131': 1352, 'L133': 1353, 'L137': 1354, 'L138': 1355, 'L144': 1356, 'L146': 1357, 'L147': 1358, 'L149': 1359, 'L150': 1360, 'L151': 1361, 'L152': 1362, 'L153': 1363, 'L154': 1364, 'L155': 1365, 'L156': 1366, 'L157': 1367, 'L158': 1368, 'L159': 1369, 'L160': 1370, 'L161': 1371, 'L17': 1372, 'L171': 1373, 'L173': 1374, 'L175': 1375, 'L176': 1376, 'L179': 1377, 'L183': 1378, 'L184': 1379, 'L186': 1380, 'L188': 1381, 'L189': 1382, 'L19': 1383, 'L192': 1384, 'L196': 1385, 'L197': 1386, 'L2': 1387, 'L20': 1388, 'L21': 1389, 'L215': 1390, 'L216': 1391, 'L217': 1392, 'L218': 1393, 'L220': 1394, 'L221': 1395, 'L222': 1396, 'L24': 1397, 'L25': 1398, 'L27': 1399, 'L28': 1400, 'L29': 1401, 'L3': 1402, 'L31': 1403, 'L33': 1404, 'L34': 1405, 'L35': 1406, 'L36': 1407, 'L40': 1408, 'L42': 1409, 'L43': 1410, 'L44': 1411, 'L45': 1412, 'L46': 1413, 'L47': 1414, 'L48': 1415, 'L49': 1416, 'L5': 1417, 'L50': 1418, 'L51': 1419, 'L52': 1420, 'L53': 1421, 'L54': 1422, 'L55': 1423, 'L56': 1424, 'L57': 1425, 'L58': 1426, 'L59': 1427, 'L60': 1428, 'L61': 1429, 'L63': 1430, 'L64': 1431, 'L65': 1432, 'L66': 1433, 'L68': 1434, 'L69': 1435, 'L7': 1436, 'L70': 1437, 'L71': 1438, 'L72': 1439, 'L75': 1440, 'L76': 1441, 'L77': 1442, 'L78': 1443, 'L79': 1444, 'L8': 1445, 'L80': 1446, 'L81': 1447, 'L82': 1448, 'L83': 1449, 'L84': 1450, 'L85': 1451, 'L86': 1452, 'L87': 1453, 'L88': 1454, 'L9': 1455, 'L91': 1456, 'L92': 1457, 'L93': 1458, 'L94': 1459, 'L95': 1460, 'L96': 1461, 'L97': 1462, 'L98': 1463, 'L99': 1464, 'M100': 1465, 'M10001': 1466, 'M10002': 1467, 'M10003': 1468, 'M10004': 1469, 'M10005': 1470, 'M10006': 1471, 'M10007': 1472, 'M10008': 1473, 'M10009': 1474, 'M10010': 1475, 'M10011': 1476, 'M10012': 1477, 'M10013': 1478, 'M10014': 1479, 'M10015': 1480, 'M10016': 1481, 'M10017': 1482, 'M10018': 1483, 'M10019': 1484, 'M10020': 1485, 'M10021': 1486, 'M10031': 1487, 'M10032': 1488, 'M10033': 1489, 'M10034': 1490, 'M10035': 1491, 'M10036': 1492, 'M10037': 1493, 'M10038': 1494, 'M10039': 1495, 'M10040': 1496, 'M10041': 1497, 'M10042': 1498, 'M10043': 1499, 'M10044': 1500, 'M10045': 1501, 'M10046': 1502, 'M10047': 1503, 'M10048': 1504, 'M10049': 1505, 'M10050': 1506, 'M10051': 1507, 'M10052': 1508, 'M10053': 1509, 'M10054': 1510, 'M10055': 1511, 'M10056': 1512, 'M10057': 1513, 'M10058': 1514, 'M10059': 1515, 'M10060': 1516, 'M10061': 1517, 'M10062': 1518, 'M10063': 1519, 'M10064': 1520, 'M10065': 1521, 'M10066': 1522, 'M10067': 1523, 'M10068': 1524, 'M10069': 1525, 'M10070': 1526, 'M10071': 1527, 'M10072': 1528, 'M10073': 1529, 'M10087': 1530, 'M1017': 1531, 'M1018': 1532, 'M1019': 1533, 'M1020': 1534, 'M1021': 1535, 'M1022': 1536, 'M1023': 1537, 'M1024': 1538, 'M1030': 1539, 'M1031': 1540, 'M1032': 1541, 'M1033': 1542, 'M1034': 1543, 'M1035': 1544, 'M1036': 1545, 'M1037': 1546, 'M1038': 1547, 'M1039': 1548, 'M1040': 1549, 'M1041': 1550, 'M1043': 1551, 'M1044': 1552, 'M1045': 1553, 'M1046': 1554, 'M1047': 1555, 'M1048': 1556, 'M1049': 1557, 'M1050': 1558, 'M1051': 1559, 'M1052': 1560, 'M1053': 1561, 'M1054': 1562, 'M1055': 1563, 'M1056': 1564, 'M1057': 1565, 'M1058': 1566, 'M1059': 1567, 'M1060': 1568, 'M1061': 1569, 'M1062': 1570, 'M1063': 1571, 'M1064': 1572, 'M1065': 1573, 'M1066': 1574, 'M1067': 1575, 'M1068': 1576, 'M1069': 1577, 'M1070': 1578, 'M1071': 1579, 'M1072': 1580, 'M1073': 1581, 'M1074': 1582, 'M1075': 1583, 'M1076': 1584, 'M1077': 1585, 'M1078': 1586, 'M1079': 1587, 'M1080': 1588, 'M1081': 1589, 'M1082': 1590, 'M1083': 1591, 'M1084': 1592, 'M1085': 1593, 'M1086': 1594, 'M1087': 1595, 'M1088': 1596, 'M1089': 1597, 'M109': 1598, 'M1090': 1599, 'M1091': 1600, 'M1092': 1601, 'M1093': 1602, 'M1094': 1603, 'M1095': 1604, 'M1096': 1605, 'M1097': 1606, 'M1098': 1607, 'M1099': 1608, 'M110': 1609, 'M1100': 1610, 'M1101': 1611, 'M1102': 1612, 'M1103': 1613, 'M1104': 1614, 'M1105': 1615, 'M1106': 1616, 'M1107': 1617, 'M1108': 1618, 'M1109': 1619, 'M1110': 1620, 'M1111': 1621, 'M1112': 1622, 'M1113': 1623, 'M1114': 1624, 'M1115': 1625, 'M1116': 1626, 'M1117': 1627, 'M1118': 1628, 'M1119': 1629, 'M1120': 1630, 'M1121': 1631, 'M1122': 1632, 'M1123': 1633, 'M1124': 1634, 'M1125': 1635, 'M1126': 1636, 'M1127': 1637, 'M1128': 1638, 'M1129': 1639, 'M1130': 1640, 'M1131': 1641, 'M1132': 1642, 'M1133': 1643, 'M1134': 1644, 'M1135': 1645, 'M1136': 1646, 'M1137': 1647, 'M1138': 1648, 'M1139': 1649, 'M1140': 1650, 'M1141': 1651, 'M1142': 1652, 'M1143': 1653, 'M1144': 1654, 'M1145': 1655, 'M1146': 1656, 'M1147': 1657, 'M1148': 1658, 'M1149': 1659, 'M1150': 1660, 'M1151': 1661, 'M1152': 1662, 'M1153': 1663, 'M1154': 1664, 'M1155': 1665, 'M1156': 1666, 'M1157': 1667, 'M1158': 1668, 'M1159': 1669, 'M1160': 1670, 'M1161': 1671, 'M1162': 1672, 'M1163': 1673, 'M1164': 1674, 'M1165': 1675, 'M1166': 1676, 'M1167': 1677, 'M1168': 1678, 'M1169': 1679, 'M1170': 1680, 'M1171': 1681, 'M1172': 1682, 'M1173': 1683, 'M1174': 1684, 'M1175': 1685, 'M1176': 1686, 'M1177': 1687, 'M1178': 1688, 'M1179': 1689, 'M1180': 1690, 'M1181': 1691, 'M1182': 1692, 'M1183': 1693, 'M1184': 1694, 'M1185': 1695, 'M1186': 1696, 'M1187': 1697, 'M1188': 1698, 'M1189': 1699, 'M1190': 1700, 'M1191': 1701, 'M1192': 1702, 'M1193': 1703, 'M1194': 1704, 'M1195': 1705, 'M1196': 1706, 'M1197': 1707, 'M1198': 1708, 'M1199': 1709, 'M120': 1710, 'M1200': 1711, 'M1201': 1712, 'M1202': 1713, 'M1203': 1714, 'M1204': 1715, 'M1205': 1716, 'M1206': 1717, 'M1207': 1718, 'M1208': 1719, 'M1209': 1720, 'M1210': 1721, 'M1211': 1722, 'M1212': 1723, 'M1213': 1724, 'M1214': 1725, 'M1215': 1726, 'M1216': 1727, 'M1217': 1728, 'M1218': 1729, 'M1219': 1730, 'M1220': 1731, 'M1221': 1732, 'M1222': 1733, 'M1223': 1734, 'M1224': 1735, 'M1225': 1736, 'M1226': 1737, 'M1227': 1738, 'M1228': 1739, 'M1229': 1740, 'M1230': 1741, 'M1231': 1742, 'M1232': 1743, 'M1233': 1744, 'M124': 1745, 'M125': 1746, 'M126': 1747, 'M127': 1748, 'M136': 1749, 'M174': 1750, 'M175': 1751, 'M176': 1752, 'M177': 1753, 'M178': 1754, 'M179': 1755, 'M180': 1756, 'M181': 1757, 'M182': 1758, 'M183': 1759, 'M185': 1760, 'M186': 1761, 'M20': 1762, 'M275': 1763, 'M278': 1764, 'M282': 1765, 'M285': 1766, 'M286': 1767, 'M325': 1768, 'M363': 1769, 'M364': 1770, 'M365': 1771, 'M366': 1772, 'M367': 1773, 'M368': 1774, 'M369': 1775, 'M370': 1776, 'M371': 1777, 'M372': 1778, 'M373': 1779, 'M374': 1780, 'M375': 1781, 'M376': 1782, 'M377': 1783, 'M378': 1784, 'M379': 1785, 'M380': 1786, 'M381': 1787, 'M382': 1788, 'M383': 1789, 'M384': 1790, 'M385': 1791, 'M386': 1792, 'M387': 1793, 'M388': 1794, 'M389': 1795, 'M390': 1796, 'M391': 1797, 'M395': 1798, 'M404': 1799, 'M409': 1800, 'M410': 1801, 'M411': 1802, 'M413': 1803, 'M415': 1804, 'M416': 1805, 'M417': 1806, 'M419': 1807, 'M420': 1808, 'M421': 1809, 'M427': 1810, 'M429': 1811, 'M43': 1812, 'M433': 1813, 'M434': 1814, 'M438': 1815, 'M439': 1816, 'M441': 1817, 'M442': 1818, 'M443': 1819, 'M446': 1820, 'M448': 1821, 'M449': 1822, 'M452': 1823, 'M458': 1824, 'M465': 1825, 'M467': 1826, 'M468': 1827, 'M469': 1828, 'M472': 1829, 'M476': 1830, 'M477': 1831, 'M485': 1832, 'M486': 1833, 'M490': 1834, 'M498': 1835, 'M502': 1836, 'M503': 1837, 'M505': 1838, 'M507': 1839, 'M509': 1840, 'M513': 1841, 'M514': 1842, 'M517': 1843, 'M524': 1844, 'M527': 1845, 'M528': 1846, 'M529': 1847, 'M53': 1848, 'M532': 1849, 'M533': 1850, 'M535': 1851, 'M537': 1852, 'M538': 1853, 'M539': 1854, 'M540': 1855, 'M589': 1856, 'M597': 1857, 'M598': 1858, 'M599': 1859, 'M600': 1860, 'M601': 1861, 'M602': 1862, 'M603': 1863, 'M604': 1864, 'M605': 1865, 'M606': 1866, 'M607': 1867, 'M609': 1868, 'M620': 1869, 'M622': 1870, 'M623': 1871, 'M72': 1872, 'M73': 1873, 'M74': 1874, 'M75': 1875, 'M76': 1876, 'M77': 1877, 'M78': 1878, 'M79': 1879, 'M80': 1880, 'M81': 1881, 'M82': 1882, 'M83': 1883, 'M84': 1884, 'M85': 1885, 'M87': 1886, 'M88': 1887, 'M89': 1888, 'M90': 1889, 'M91': 1890, 'M92': 1891, 'M93': 1892, 'M94': 1893, 'M95': 1894, 'M96': 1895, 'M97': 1896, 'M98': 1897, 'M99': 1898, 'N1': 1899, 'N1010': 1900, 'N1015': 1901, 'N1016': 1902, 'N1017': 1903, 'N1018': 1904, 'N1019': 1905, 'N1020': 1906, 'N1021': 1907, 'N1022': 1908, 'N1023': 1909, 'N1024': 1910, 'N1025': 1911, 'N1026': 1912, 'N1027': 1913, 'N1028': 1914, 'N1029': 1915, 'N1030': 1916, 'N1031': 1917, 'N1032': 1918, 'N1033': 1919, 'N1034': 1920, 'N1035': 1921, 'N1036': 1922, 'N1038': 1923, 'N1039': 1924, 'N1040': 1925, 'N1041': 1926, 'N1042': 1927, 'N1043': 1928, 'N1044': 1929, 'N1045': 1930, 'N1046': 1931, 'N1047': 1932, 'N1048': 1933, 'N1049': 1934, 'N1050': 1935, 'N1051': 1936, 'N1052': 1937, 'N1053': 1938, 'N1054': 1939, 'N1055': 1940, 'N11': 1941, 'N12': 1942, 'N14': 1943, 'N19': 1944, 'N2': 1945, 'N20': 1946, 'N21': 1947, 'N22': 1948, 'N29': 1949, 'N3': 1950, 'N30': 1951, 'N31': 1952, 'N32': 1953, 'N33': 1954, 'N34': 1955, 'N35': 1956, 'N38': 1957, 'N39': 1958, 'N4': 1959, 'N42': 1960, 'N43': 1961, 'N46': 1962, 'N47': 1963, 'N48': 1964, 'N49': 1965, 'N5': 1966, 'N50': 1967, 'N51': 1968, 'N52': 1969, 'N53': 1970, 'N54': 1971, 'N55': 1972, 'N56': 1973, 'N57': 1974, 'N58': 1975, 'N59': 1976, 'N6': 1977, 'N60': 1978, 'N61': 1979, 'N62': 1980, 'N63': 1981, 'N64': 1982, 'N65': 1983, 'N66': 1984, 'N7': 1985, 'N76': 1986, 'N77': 1987, 'N8': 1988, 'N9': 1989, 'P1': 1990, 'P10001': 1991, 'P10002': 1992, 'P10003': 1993, 'P10004': 1994, 'P10005': 1995, 'P10006': 1996, 'P10007': 1997, 'P10008': 1998, 'P10009': 1999, 'P10010': 2000, 'P10011': 2001, 'P10012': 2002, 'P10013': 2003, 'P10014': 2004, 'P10015': 2005, 'P10016': 2006, 'P10017': 2007, 'P1003': 2008, 'P1004': 2009, 'P1005': 2010, 'P1006': 2011, 'P1007': 2012, 'P1010': 2013, 'P1011': 2014, 'P11': 2015, 'P12': 2016, 'P13': 2017, 'P16': 2018, 'P18': 2019, 'P19': 2020, 'P2': 2021, 'P21': 2022, 'P22': 2023, 'P24': 2024, 'P26': 2025, 'P27': 2026, 'P28': 2027, 'P31': 2028, 'P32': 2029, 'P33': 2030, 'P34': 2031, 'P35': 2032, 'P36': 2033, 'P37': 2034, 'P39': 2035, 'P40': 2036, 'P41': 2037, 'P43': 2038, 'P45': 2039, 'P46': 2040, 'P47': 2041, 'P48': 2042, 'P5': 2043, 'P52': 2044, 'P54': 2045, 'P55': 2046, 'P56': 2047, 'P57': 2048, 'P59': 2049, 'P6': 2050, 'P62': 2051, 'P68': 2052, 'P70': 2053, 'P71': 2054, 'P72': 2055, 'P73': 2056, 'P75': 2057, 'Q10005': 2058, 'Q10006': 2059, 'Q10007': 2060, 'Q1003': 2061, 'Q1004': 2062, 'Q1007': 2063, 'Q1008': 2064, 'Q1014': 2065, 'Q1015': 2066, 'Q1019': 2067, 'Q1020': 2068, 'Q1021': 2069, 'Q1023': 2070, 'Q1024': 2071, 'Q1025': 2072, 'Q1026': 2073, 'Q1027': 2074, 'Q1028': 2075, 'Q1029': 2076, 'Q1031': 2077, 'Q1033': 2078, 'Q1034': 2079, 'Q1035': 2080, 'Q1036': 2081, 'Q1037': 2082, 'Q1038': 2083, 'Q1039': 2084, 'Q1041': 2085, 'Q1042': 2086, 'Q1043': 2087, 'Q1044': 2088, 'Q1045': 2089, 'Q1046': 2090, 'Q1047': 2091, 'Q1048': 2092, 'Q1049': 2093, 'Q1050': 2094, 'Q1051': 2095, 'Q1052': 2096, 'Q1053': 2097, 'Q1054': 2098, 'Q1055': 2099, 'Q1056': 2100, 'Q1057': 2101, 'Q1058': 2102, 'Q1059': 2103, 'Q1060': 2104, 'Q1061': 2105, 'Q1062': 2106, 'Q1063': 2107, 'Q1064': 2108, 'Q11': 2109, 'Q18': 2110, 'Q2': 2111, 'Q23': 2112, 'Q24': 2113, 'Q25': 2114, 'Q27': 2115, 'Q34': 2116, 'Q35': 2117, 'Q43': 2118, 'Q44': 2119, 'Q6': 2120, 'R10001': 2121, 'R10002': 2122, 'R10003': 2123, 'R10004': 2124, 'R10005': 2125, 'R10006': 2126, 'R10007': 2127, 'R10008': 2128, 'R10009': 2129, 'R10010': 2130, 'R10011': 2131, 'R10012': 2132, 'R10013': 2133, 'R10014': 2134, 'R10015': 2135, 'R10017': 2136, 'R10018': 2137, 'R10019': 2138, 'R10020': 2139, 'R10021': 2140, 'R10022': 2141, 'R10023': 2142, 'R10024': 2143, 'R10025': 2144, 'R10026': 2145, 'R10027': 2146, 'R10028': 2147, 'R10029': 2148, 'R10030': 2149, 'R10031': 2150, 'R10032': 2151, 'R10033': 2152, 'R10034': 2153, 'R10035': 2154, 'R10036': 2155, 'R10037': 2156, 'R10038': 2157, 'R10040': 2158, 'R10560': 2159, 'R10635': 2160, 'R10636': 2161, 'R332': 2162, 'R5740': 2163, 'R5741': 2164, 'R5745': 2165, 'R5748': 2166, 'S1': 2167, 'S10001': 2168, 'S10002': 2169, 'S10005': 2170, 'S1001': 2171, 'S1002': 2172, 'S1003': 2173, 'S1004': 2174, 'S1005': 2175, 'S1006': 2176, 'S1007': 2177, 'S1008': 2178, 'S1009': 2179, 'S1014': 2180, 'S1015': 2181, 'S1016': 2182, 'S1017': 2183, 'S1018': 2184, 'S1019': 2185, 'S14': 2186, 'S2': 2187, 'S22': 2188, 'S23': 2189, 'S28': 2190, 'S29': 2191, 'S3': 2192, 'S30': 2193, 'S31': 2194, 'S32': 2195, 'S33': 2196, 'S34': 2197, 'S35': 2198, 'S36': 2199, 'S37': 2200, 'S39': 2201, 'S4': 2202, 'S40': 2203, 'S42': 2204, 'S43': 2205, 'S45': 2206, 'S46': 2207, 'S47': 2208, 'S48': 2209, 'S49': 2210, 'S50': 2211, 'S51': 2212, 'S52': 2213, 'S53': 2214, 'S55': 2215, 'S56': 2216, 'S57': 2217, 'S61': 2218, 'S64': 2219, 'S68': 2220, 'S69': 2221, 'S7': 2222, 'S70': 2223, 'S71': 2224, 'S72': 2225, 'S73': 2226, 'S74': 2227, 'S75': 2228, 'S76': 2229, 'S77': 2230, 'S78': 2231, 'S79': 2232, 'S8': 2233, 'T1': 2234, 'T10': 2235, 'T1002': 2236, 'T1003': 2237, 'T1004': 2238, 'T1005': 2239, 'T1006': 2240, 'T1007': 2241, 'T1008': 2242, 'T1009': 2243, 'T1010': 2244, 'T1015': 2245, 'T1018': 2246, 'T1019': 2247, 'T1020': 2248, 'T1021': 2249, 'T1022': 2250, 'T1023': 2251, 'T1024': 2252, 'T1025': 2253, 'T1026': 2254, 'T1027': 2255, 'T1028': 2256, 'T11': 2257, 'T12': 2258, 'T13': 2259, 'T14': 2260, 'T15': 2261, 'T17': 2262, 'T19': 2263, 'T2': 2264, 'T20': 2265, 'T23': 2266, 'T24': 2267, 'T25': 2268, 'T26': 2269, 'T30': 2270, 'T31': 2271, 'T32': 2272, 'T39': 2273, 'T40': 2274, 'T42': 2275, 'T45': 2276, 'T6': 2277, 'T7': 2278, 'T8': 2279, 'T9': 2280, 'U1': 2281, 'U10001': 2282, 'U10002': 2283, 'U10003': 2284, 'U10004': 2285, 'U10005': 2286, 'U10006': 2287, 'U10007': 2288, 'U10008': 2289, 'U10009': 2290, 'U1001': 2291, 'U10010': 2292, 'U10011': 2293, 'U10012': 2294, 'U10013': 2295, 'U10014': 2296, 'U10015': 2297, 'U10016': 2298, 'U10017': 2299, 'U10018': 2300, 'U10019': 2301, 'U10022': 2302, 'U10023': 2303, 'U10024': 2304, 'U10025': 2305, 'U10027': 2306, 'U10028': 2307, 'U1003': 2308, 'U1004': 2309, 'U1006': 2310, 'U1008': 2311, 'U1009': 2312, 'U1010': 2313, 'U1011': 2314, 'U1012': 2315, 'U1013': 2316, 'U1014': 2317, 'U1015': 2318, 'U1016': 2319, 'U1017': 2320, 'U1023': 2321, 'U1024': 2322, 'U11': 2323, 'U18': 2324, 'U19': 2325, 'U2': 2326, 'U21': 2327, 'U22': 2328, 'U23': 2329, 'U24': 2330, 'U25': 2331, 'U26': 2332, 'U27': 2333, 'U28': 2334, 'U3': 2335, 'U30': 2336, 'U31': 2337, 'U33': 2338, 'U34': 2339, 'U35': 2340, 'U36': 2341, 'U37': 2342, 'U39': 2343, 'U4': 2344, 'U40': 2345, 'U47': 2346, 'U5': 2347, 'U56': 2348, 'U57': 2349, 'U58': 2350, 'U61': 2351, 'U66': 2352, 'U67': 2353, 'U68': 2354, 'U70': 2355, 'V1': 2356, 'V10': 2357, 'V10001': 2358, 'V10002': 2359, 'V1001': 2360, 'V1002': 2361, 'V1003': 2362, 'V1004': 2363, 'V1005': 2364, 'V1006': 2365, 'V1007': 2366, 'V1008': 2367, 'V11': 2368, 'V12': 2369, 'V13': 2370, 'V14': 2371, 'V15': 2372, 'V17': 2373, 'V18': 2374, 'V19': 2375, 'V2': 2376, 'V20': 2377, 'V22': 2378, 'V23': 2379, 'V24': 2380, 'V25': 2381, 'V26': 2382, 'V27': 2383, 'V3': 2384, 'V4': 2385, 'V53': 2386, 'V55': 2387, 'V57': 2388, 'V59': 2389, 'V6': 2390, 'V65': 2391, 'V66': 2392, 'V67': 2393, 'V68': 2394, 'V7': 2395, 'V79': 2396, 'V8': 2397, 'V80': 2398, 'V9': 2399, 'W1': 2400, 'W10': 2401, 'W1009': 2402, 'W1010': 2403, 'W1011': 2404, 'W1012': 2405, 'W1013': 2406, 'W1014': 2407, 'W1015': 2408, 'W1016': 2409, 'W1018': 2410, 'W1019': 2411, 'W1022': 2412, 'W1023': 2413, 'W1024': 2414, 'W1025': 2415, 'W1026': 2416, 'W1027': 2417, 'W1028': 2418, 'W1029': 2419, 'W12': 2420, 'W14': 2421, 'W15': 2422, 'W16': 2423, 'W18': 2424, 'W19': 2425, 'W2': 2426, 'W20': 2427, 'W21': 2428, 'W22': 2429, 'W23': 2430, 'W24': 2431, 'W25': 2432, 'W26': 2433, 'W27': 2434, 'W29': 2435, 'W3': 2436, 'W30': 2437, 'W31': 2438, 'W32': 2439, 'W36': 2440, 'W4': 2441, 'W40': 2442, 'W43': 2443, 'W44': 2444, 'W45': 2445, 'W46': 2446, 'W47': 2447, 'W48': 2448, 'W5': 2449, 'W51': 2450, 'W52': 2451, 'W53': 2452, 'W54': 2453, 'W57': 2454, 'W58': 2455, 'W6': 2456, 'W60': 2457, 'W61': 2458, 'W67': 2459, 'W68': 2460, 'W69': 2461, 'W7': 2462, 'W70': 2463, 'W71': 2464, 'W72': 2465, 'W73': 2466, 'W74': 2467, 'W8': 2468, 'X10': 2469, 'X100': 2470, 'X10001': 2471, 'X10003': 2472, 'X10004': 2473, 'X10005': 2474, 'X10006': 2475, 'X10007': 2476, 'X10008': 2477, 'X10009': 2478, 'X1001': 2479, 'X10010': 2480, 'X10011': 2481, 'X10012': 2482, 'X10013': 2483, 'X10018': 2484, 'X1002': 2485, 'X10021': 2486, 'X10026': 2487, 'X1003': 2488, 'X10030': 2489, 'X10031': 2490, 'X10032': 2491, 'X10033': 2492, 'X10034': 2493, 'X10035': 2494, 'X10036': 2495, 'X10037': 2496, 'X10038': 2497, 'X10039': 2498, 'X1004': 2499, 'X10040': 2500, 'X10044': 2501, 'X10046': 2502, 'X10047': 2503, 'X10048': 2504, 'X10050': 2505, 'X10052': 2506, 'X10053': 2507, 'X10054': 2508, 'X10055': 2509, 'X10056': 2510, 'X10061': 2511, 'X101': 2512, 'X1010': 2513, 'X1012': 2514, 'X1013': 2515, 'X1014': 2516, 'X1016': 2517, 'X1017': 2518, 'X1018': 2519, 'X1019': 2520, 'X102': 2521, 'X1020': 2522, 'X1021': 2523, 'X1022': 2524, 'X1025': 2525, 'X1026': 2526, 'X1029': 2527, 'X103': 2528, 'X1030': 2529, 'X1032': 2530, 'X1033': 2531, 'X1037': 2532, 'X1038': 2533, 'X1039': 2534, 'X104': 2535, 'X1040': 2536, 'X1042': 2537, 'X1043': 2538, 'X1044': 2539, 'X1045': 2540, 'X1046': 2541, 'X1047': 2542, 'X1048': 2543, 'X1049': 2544, 'X1050': 2545, 'X1051': 2546, 'X1052': 2547, 'X1053': 2548, 'X1054': 2549, 'X1055': 2550, 'X1057': 2551, 'X1058': 2552, 'X1060': 2553, 'X1063': 2554, 'X1064': 2555, 'X107': 2556, 'X1073': 2557, 'X1074': 2558, 'X1075': 2559, 'X1076': 2560, 'X1077': 2561, 'X1078': 2562, 'X1079': 2563, 'X1080': 2564, 'X1081': 2565, 'X1083': 2566, 'X1086': 2567, 'X1087': 2568, 'X1088': 2569, 'X1089': 2570, 'X109': 2571, 'X1091': 2572, 'X1092': 2573, 'X1093': 2574, 'X1094': 2575, 'X1095': 2576, 'X1096': 2577, 'X1097': 2578, 'X1099': 2579, 'X11': 2580, 'X1100': 2581, 'X1101': 2582, 'X1102': 2583, 'X1103': 2584, 'X1104': 2585, 'X1105': 2586, 'X1106': 2587, 'X1107': 2588, 'X1108': 2589, 'X1109': 2590, 'X111': 2591, 'X1110': 2592, 'X1111': 2593, 'X1112': 2594, 'X1113': 2595, 'X1114': 2596, 'X1115': 2597, 'X1116': 2598, 'X1117': 2599, 'X1118': 2600, 'X1119': 2601, 'X1120': 2602, 'X1121': 2603, 'X1122': 2604, 'X1124': 2605, 'X1125': 2606, 'X1126': 2607, 'X1127': 2608, 'X1128': 2609, 'X1129': 2610, 'X113': 2611, 'X1130': 2612, 'X1131': 2613, 'X1132': 2614, 'X1133': 2615, 'X1134': 2616, 'X1135': 2617, 'X1136': 2618, 'X1137': 2619, 'X1138': 2620, 'X1139': 2621, 'X114': 2622, 'X1141': 2623, 'X1143': 2624, 'X1145': 2625, 'X1146': 2626, 'X1147': 2627, 'X1148': 2628, 'X1149': 2629, 'X1150': 2630, 'X1151': 2631, 'X1152': 2632, 'X1153': 2633, 'X1154': 2634, 'X1155': 2635, 'X1156': 2636, 'X1157': 2637, 'X1158': 2638, 'X1159': 2639, 'X1160': 2640, 'X1161': 2641, 'X1162': 2642, 'X1163': 2643, 'X1164': 2644, 'X1165': 2645, 'X1166': 2646, 'X1167': 2647, 'X1168': 2648, 'X1169': 2649, 'X1170': 2650, 'X1171': 2651, 'X1172': 2652, 'X1173': 2653, 'X1174': 2654, 'X1175': 2655, 'X1176': 2656, 'X1177': 2657, 'X1178': 2658, 'X1179': 2659, 'X1181': 2660, 'X1183': 2661, 'X1184': 2662, 'X1185': 2663, 'X1186': 2664, 'X1187': 2665, 'X1189': 2666, 'X1190': 2667, 'X1191': 2668, 'X1192': 2669, 'X1193': 2670, 'X1195': 2671, 'X1197': 2672, 'X1198': 2673, 'X1199': 2674, 'X12': 2675, 'X120': 2676, 'X1200': 2677, 'X1201': 2678, 'X1202': 2679, 'X121': 2680, 'X1211': 2681, 'X1212': 2682, 'X1213': 2683, 'X1214': 2684, 'X1215': 2685, 'X1216': 2686, 'X1217': 2687, 'X1218': 2688, 'X1219': 2689, 'X1220': 2690, 'X1221': 2691, 'X1222': 2692, 'X1223': 2693, 'X1224': 2694, 'X1225': 2695, 'X1226': 2696, 'X1227': 2697, 'X1228': 2698, 'X1229': 2699, 'X1231': 2700, 'X1234': 2701, 'X1235': 2702, 'X1236': 2703, 'X1238': 2704, 'X1239': 2705, 'X1240': 2706, 'X1241': 2707, 'X1242': 2708, 'X1243': 2709, 'X1244': 2710, 'X1246': 2711, 'X1247': 2712, 'X1248': 2713, 'X125': 2714, 'X1250': 2715, 'X1251': 2716, 'X1252': 2717, 'X1253': 2718, 'X1254': 2719, 'X1255': 2720, 'X1256': 2721, 'X1257': 2722, 'X1258': 2723, 'X1259': 2724, 'X126': 2725, 'X1260': 2726, 'X1261': 2727, 'X1262': 2728, 'X1263': 2729, 'X1264': 2730, 'X1265': 2731, 'X1266': 2732, 'X1267': 2733, 'X1268': 2734, 'X1269': 2735, 'X1270': 2736, 'X1271': 2737, 'X1272': 2738, 'X1273': 2739, 'X1274': 2740, 'X1279': 2741, 'X128': 2742, 'X1280': 2743, 'X1281': 2744, 'X1282': 2745, 'X1283': 2746, 'X1284': 2747, 'X1285': 2748, 'X129': 2749, 'X130': 2750, 'X134': 2751, 'X136': 2752, 'X137': 2753, 'X138': 2754, 'X139': 2755, 'X14': 2756, 'X142': 2757, 'X143': 2758, 'X146': 2759, 'X147': 2760, 'X148': 2761, 'X15': 2762, 'X154': 2763, 'X155': 2764, 'X178': 2765, 'X181': 2766, 'X184': 2767, 'X2': 2768, 'X229': 2769, 'X230': 2770, 'X237': 2771, 'X239': 2772, 'X24': 2773, 'X249': 2774, 'X250': 2775, 'X251': 2776, 'X257': 2777, 'X258': 2778, 'X259': 2779, 'X260': 2780, 'X267': 2781, 'X268': 2782, 'X269': 2783, 'X273': 2784, 'X276': 2785, 'X277': 2786, 'X278': 2787, 'X282': 2788, 'X287': 2789, 'X289': 2790, 'X292': 2791, 'X293': 2792, 'X294': 2793, 'X295': 2794, 'X298': 2795, 'X3': 2796, 'X30': 2797, 'X302': 2798, 'X305': 2799, 'X306': 2800, 'X307': 2801, 'X310': 2802, 'X312': 2803, 'X313': 2804, 'X314': 2805, 'X315': 2806, 'X316': 2807, 'X317': 2808, 'X318': 2809, 'X319': 2810, 'X32': 2811, 'X320': 2812, 'X321': 2813, 'X322': 2814, 'X323': 2815, 'X324': 2816, 'X325': 2817, 'X326': 2818, 'X327': 2819, 'X328': 2820, 'X329': 2821, 'X40': 2822, 'X46': 2823, 'X47': 2824, 'X48': 2825, 'X55': 2826, 'X56': 2827, 'X57': 2828, 'X58': 2829, 'X59': 2830, 'X6': 2831, 'X61': 2832, 'X63': 2833, 'X64': 2834, 'X65': 2835, 'X68': 2836, 'X7': 2837, 'X75': 2838, 'X76': 2839, 'X77': 2840, 'X78': 2841, 'X79': 2842, 'X8': 2843, 'X82': 2844, 'X85': 2845, 'X86': 2846, 'X87': 2847, 'X88': 2848, 'X89': 2849, 'X90': 2850, 'X91': 2851, 'X92': 2852, 'X93': 2853, 'X94': 2854, 'X95': 2855, 'X97': 2856, 'X98': 2857}

        try:
            return {
                "NZCompId": csm["FoodID"][0],
                "foodId": food_id_mapping[csm["FoodID"][0]],
                "csmDescription": csm["CSM"][0],
                "amount": safe_float(csm["Measure"][0]),
                "density": safe_float(csm["Density (g/cm3)"][0])
            }
        except KeyError as e:
            print(f"Missing key: {e}")
            return None
        except ValueError as e:
            print(f"Value error: {e}")
            return None

    # def print(self, num=1, reformat=False):
    #     for food in [self.food_data[1]]:
    #         if reformat:
    #             food = self.__reformat_food_entry(food)
    #         for key, val in food.items():
    #             print(key, val)
    #         print("-"*75)

    def send_food_post_requests(self):
        i = 1
        for food in self.food_data:
            data = self.__reformat_food_entry(food)
            if data:
                response = requests.post(self.food_request_url, json=data)
                print(f"Sent {data['name']}: {response.status_code} - {response.text}")
                self.id_mapping.append((data["NZCompId"], i))
                i += 1
            else:
                print(f"Skipped FOOD")

        print(self.id_mapping)

    def send_csm_post_requests(self):
        for csm in self.csm_data:
            data = self.__reformat_csm_entry(csm)
            if data:
                response = requests.post(self.csm_request_url, json=data)
                # print(f"Sent {data['name']}: {response.status_code} - {response.text}")
                print(response.status_code)
            else:
                print(f"Skipped FOOD")


class ProcessOpenFoodFactsData:
    """TODO (maybe)"""
    def __init__(self):
        pass


if __name__ == "__main__":
    processor = ProcessNZFoodCompData(STANDARD_FILE_PATH, CSM_FILE_PATH, FOOD_REQUEST_URL, CSM_REQUEST_URL)

    # Send post requests
    processor.send_food_post_requests()
    processor.send_csm_post_requests()
